# -*- coding: utf-8 -*-
"""Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1SFNEmwS5i6vDEHCnpTobwQXKcCX8cFv-
"""

import pandas as pd
import numpy as np
!pip install catboost
from catboost import CatBoostRegressor

import os

model_filename = 'catboost_tuned_movie_predictor.cbm'

loaded_model = CatBoostRegressor()
loaded_model.load_model(model_filename)


feature_cols = [
    'release_year', 'budget', 'runtime', 'is_sequel',
    'director_name', 'director_popularity',
    'lead_actor1', 'lead_actor1_popularity',
    'primary_genre', 'genre2',
    'studio_1', 'studio_2', 'brand_name',
    'mpaa_rating', 'release_month', 'is_holiday_release', 'Distributor'
]

avatar_data = {
    'release_year': 2025,
    'budget': 250000000,
    'runtime': 197,
    'is_sequel': 1,
    'director_name': 'James Cameron',
    'director_popularity': 4.3403,
    'lead_actor1': 'Sam Worthington',
    'lead_actor1_popularity': 4.0107,
    'primary_genre': 'Action',
    'genre2': 'Adventure',
    'studio_1': '20th Century Studios',
    'studio_2': 'Lightstorm Entertainment',
    'brand_name': 'Avatar',
    'mpaa_rating': 'PG-13',
    'release_month': 12,
    'is_holiday_release': 1,
    'Distributor': '20th Century Studios'
}

avatar_df = pd.DataFrame([avatar_data])

avatar_df = avatar_df[feature_cols]

predicted_income = loaded_model.predict(avatar_df)[0]

print(f"\n--- Prediction for 'Avatar: Fire and Ash' (Tuned Model) ---")
print(f"Predicted First Week Income: ${predicted_income:,.2f}")